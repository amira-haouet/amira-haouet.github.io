<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:param name="lang" select="'fr'" />
  <xsl:output method="html" doctype-system="about:legacy-compat" encoding="UTF-8" indent="yes" />

  <xsl:template match="/">
    <html lang="{$lang}" prefix="foaf: http://xmlns.com/foaf/0.1/ 
          dc: http://purl.org/dc/terms/
          rdfs: http://www.w3.org/2000/01/rdf-schema#
          xsd: http://www.w3.org/2001/XMLSchema#">

    <head>
      <link rel="alternate" href="fr.html" hreflang="fr" />
      <link rel="alternate" href="en.html" hreflang="en" />
      <link rel="alternate" href="ar.html" hreflang="ar" />
      <link rel="alternate" href="ja.html" hreflang="ja" />

      <meta charset="UTF-8" />

      <!-- Métadonnées Dublin Core -->
      <meta property="dc:creator" content="Amira Haouet" />
      <meta property="dc:language" content="{$lang}" />
      <meta property="dc:title" content="{//block[@id='personal_title']/content[@lang=$lang]}" />
      <meta property="dc:description" content="{//block[@id='meta_description']/content[@lang=$lang]}" />
      <meta property="dc:date" content="2025" />

      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Amira Haouet – <xsl:value-of select="//block[@id='personal_title']/content[@lang=$lang]" /></title>
      <meta name="description" content="{//block[@id='meta_description']/content[@lang=$lang]}" />
      <meta name="keywords" content="{//block[@id='meta_keywords']/content[@lang=$lang]}" />
      <meta name="author" content="Amira Haouet" />

      <link rel="icon" href="/static/favicon.ico" type="image/x-icon" />
      <link rel="stylesheet" href="/static/css/style.css" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
      <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    </head>

    <body lang="{$lang}" vocab="http://xmlns.com/foaf/0.1/" typeof="foaf:Person">

      <!-- Splash et particules -->
      <div class="loading-screen" id="loadingScreen">
        <div class="loading-spinner"></div>
        <div class="loading-text"><xsl:value-of select="//block[@id='loading_text']/content[@lang=$lang]" /></div>
      </div>
      <div class="particles" id="particles"></div>

      <!-- Navbar -->
      <nav class="navbar">
        <div class="nav-container">
          <div class="nav-logo" data-aos="fade-down">
            <span property="foaf:name"><xsl:value-of
                select="//block[@id='personal_name']/content[@lang=$lang]" /></span>
          </div>
          <ul class="nav-menu">
            <li class="nav-item"><a href="#home" class="nav-link"><xsl:value-of
                  select="//block[@id='nav_home']/content[@lang=$lang]" /></a></li>
            <li class="nav-item"><a href="#about" class="nav-link"><xsl:value-of
                  select="//block[@id='nav_about']/content[@lang=$lang]" /></a></li>
            <li class="nav-item"><a href="#skills" class="nav-link"><xsl:value-of
                  select="//block[@id='nav_skills']/content[@lang=$lang]" /></a></li>
            <li class="nav-item"><a href="#experience" class="nav-link"><xsl:value-of
                  select="//block[@id='nav_experience']/content[@lang=$lang]" /></a></li>
            <li class="nav-item"><a href="#education" class="nav-link"><xsl:value-of
                  select="//block[@id='nav_education']/content[@lang=$lang]" /></a></li>
            <li class="nav-item"><a href="#contact" class="nav-link nav-cta"><xsl:value-of
                  select="//block[@id='nav_contact']/content[@lang=$lang]" /></a></li>
          </ul>

          <div class="language-selector-nav">
            <a href="?lang=fr" aria-label="Français">
              <img src="/static/assets/fr.png" alt="FR" width="24" />
            </a>
            <a href="?lang=en" aria-label="English">
              <img src="/static/assets/en.png" alt="EN" width="24" />
            </a>
            <a href="?lang=ar" aria-label="العربية">
              <img src="/static/assets/ar.png" alt="AR" width="24" />
            </a>
            <a href="?lang=ja" aria-label="日本語">
              <img src="/static/assets/ja.png" alt="JA" width="24" />
            </a>
          </div>

          <div class="hamburger"><span class="bar"></span><span class="bar"></span><span class="bar"></span></div>
        </div>
      </nav>

      <!-- Section Home avec informations FOAF principales -->
      <section id="home" class="hero">
        <div class="hero-container">
          <div class="hero-content" data-aos="fade-right">
            <h1 property="foaf:name"><xsl:value-of select="//block[@id='personal_name']/content[@lang=$lang]" /></h1>
            <div class="typewriter"><span class="typewriter-text"></span></div>
            <p class="hero-description" property="foaf:title"><xsl:value-of
                select="//block[@id='personal_title']/content[@lang=$lang]" /></p>

            <!-- Informations personnelles FOAF cachées pour les robots -->
            <div style="display: none;">
              <span property="foaf:givenName"><xsl:value-of
                  select="//block[@id='personal_given_name']/content[@lang=$lang]" /></span>
              <span property="foaf:familyName"><xsl:value-of
                  select="//block[@id='personal_family_name']/content[@lang=$lang]" /></span>
              <span property="foaf:gender"><xsl:value-of
                  select="//block[@id='personal_gender']/content[@lang=$lang]" /></span>
            </div>

            <div class="hero-buttons">
              <a href="#contact" class="btn btn-primary"><xsl:value-of
                  select="//block[@id='btn_contact']/content[@lang=$lang]" /></a>
              <a href="/static/assets/CvAmiraHAOUET_SP.pdf" download="" property="foaf:page"
                class="btn btn-secondary"><xsl:value-of select="//block[@id='btn_download']/content[@lang=$lang]" /></a>
            </div>

            <div class="social-links">
              <a href="{//block[@id='account_linkedin_url']/content[@lang=$lang]}" target="_blank"
                property="foaf:account" typeof="foaf:OnlineAccount">
                <i class="fab fa-linkedin"></i>
                <span style="display: none;" property="foaf:accountServiceHomepage"
                  resource="https://linkedin.com"></span>
                <span style="display: none;" property="foaf:accountName"><xsl:value-of
                    select="//block[@id='account_linkedin_name']/content[@lang=$lang]" /></span>
              </a>
              <a href="mailto:{//block[@id='personal_email']/content[@lang=$lang]}" property="foaf:mbox"><i
                  class="fas fa-envelope"></i></a>
            </div>
          </div>

          <div class="hero-image" data-aos="fade-left">
            <div class="image-wrapper">
              <img src="/static/assets/profile.jpg" alt="{//block[@id='personal_name']/content[@lang=$lang]}"
                property="foaf:img" />
            </div>
          </div>
        </div>
      </section>

      <!-- Section About -->
      <section id="about" class="section" data-aos="fade-up">
        <div class="container">
          <div class="section-header">
            <h2><xsl:value-of select="//block[@id='nav_about']/content[@lang=$lang]" /></h2>
            <p class="section-subtitle"><xsl:value-of select="//block[@id='subtitle_about']/content[@lang=$lang]" /></p>
          </div>
          <div class="about-content">
            <div property="foaf:currentProject" typeof="foaf:Project">
              <p>Actuellement <span property="foaf:title"><xsl:value-of
                    select="//block[@id='personal_title']/content[@lang=$lang]" /></span> chez
                <span property="foaf:member" typeof="foaf:Organization">
                  <span property="foaf:name"><xsl:value-of
                      select="//block[@id='org_holydis']/content[@lang=$lang]" /></span>
                </span>, je me spécialise dans le développement d'applications intelligentes et la recherche en IA.
              </p>
            </div>

            <div property="foaf:interest">
              <p><xsl:value-of select="//block[@id='personal_description']/content[@lang=$lang]" /></p>
            </div>
          </div>
        </div>
      </section>

      <!-- Section Skills -->
      <section id="skills" class="section" data-aos="fade-up">
        <div class="container">
          <div class="section-header">
            <h2><xsl:value-of select="//block[@id='skills_title']/content[@lang=$lang]" /></h2>
            <p class="section-subtitle"><xsl:value-of select="//block[@id='subtitle_skills']/content[@lang=$lang]" />
            </p>
          </div>
          <div class="skills-grid">
            <div property="foaf:topic_interest">
              <h3>Langages de Programmation</h3>
              <p>
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_python']/content[@lang=$lang]" /></span>,
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_csharp']/content[@lang=$lang]" /></span>,
                <span property="foaf:topic_interest">Java</span>,
                <span property="foaf:topic_interest">JavaScript</span>
              </p>
            </div>

            <div property="foaf:topic_interest">
              <h3>Technologies Web et Données</h3>
              <p>
                <span property="foaf:topic_interest">SQL</span>,
                <span property="foaf:topic_interest">XML</span>,
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_rdf']/content[@lang=$lang]" /></span>,
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_sparql']/content[@lang=$lang]" /></span>
              </p>
            </div>

            <div property="foaf:topic_interest">
              <h3>Domaines d'Expertise</h3>
              <p>
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_ai']/content[@lang=$lang]" /></span>,
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_semantic_web']/content[@lang=$lang]" /></span>,
                <span property="foaf:topic_interest"><xsl:value-of
                    select="//block[@id='interest_fullstack']/content[@lang=$lang]" /></span>
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- Section Experience -->
      <section id="experience" class="section" data-aos="fade-up">
        <div class="container">
          <div class="section-header">
            <h2><xsl:value-of select="//block[@id='experience_title']/content[@lang=$lang]" /></h2>
            <p class="section-subtitle"><xsl:value-of
                select="//block[@id='subtitle_experience']/content[@lang=$lang]" /></p>
          </div>

          <div class="experience-list">
            <div property="foaf:workplaceHomepage" typeof="foaf:Organization">
              <h3><xsl:value-of select="//block[@id='exp_holydis_ai']/content[@lang=$lang]" /></h3>
              <p class="period">Juillet 2024 – Présent</p>
              <div property="foaf:currentProject" typeof="foaf:Project">
                <p property="foaf:name"><xsl:value-of select="//block[@id='current_project_ai']/content[@lang=$lang]" />
                </p>
              </div>
            </div>

            <div property="foaf:workplaceHomepage" typeof="foaf:Organization">
              <h3><xsl:value-of select="//block[@id='exp_holydis_fs']/content[@lang=$lang]" /></h3>
              <p class="period">Septembre 2023 – Juillet 2024</p>
              <div property="foaf:currentProject" typeof="foaf:Project">
                <p property="foaf:name">Développement d'applications web complètes</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Section Education -->
      <section id="education" class="section" data-aos="fade-up">
        <div class="container">
          <div class="section-header">
            <h2><xsl:value-of select="//block[@id='education_title']/content[@lang=$lang]" /></h2>
            <p class="section-subtitle"><xsl:value-of select="//block[@id='subtitle_education']/content[@lang=$lang]" />
            </p>
          </div>

          <div class="education-list">
            <div property="foaf:schoolHomepage" typeof="foaf:Organization">
              <h3>Ingénierie Informatique</h3>
              <p property="foaf:name"><xsl:value-of select="//block[@id='org_sorbonne']/content[@lang=$lang]" /></p>
              <p class="period">2023 – 2026</p>
            </div>

            <div property="foaf:schoolHomepage" typeof="foaf:Organization">
              <h3>Licence Informatique</h3>
              <p property="foaf:name"><xsl:value-of select="//block[@id='org_upjv']/content[@lang=$lang]" /></p>
              <p class="period">2022 – 2023</p>
            </div>
          </div>
        </div>
      </section>

      <!-- Section Projets Web Sémantique -->
      <section id="ws" class="section" data-aos="fade-up">
        <div class="container">
          <h2><xsl:value-of select="//block[@id='tp_ws_title']/content[@lang=$lang]" /></h2>
          <div property="foaf:currentProject" typeof="foaf:Project">
            <h3 property="foaf:name"><xsl:value-of select="//block[@id='current_project_ws']/content[@lang=$lang]" />
            </h3>
            <ul>
              <li property="foaf:topic_interest"><xsl:value-of select="//block[@id='tp_ws_dtd']/content[@lang=$lang]" />
              </li>
              <li property="foaf:topic_interest"><xsl:value-of select="//block[@id='tp_ws_xsd']/content[@lang=$lang]" />
              </li>
              <li property="foaf:topic_interest"><xsl:value-of
                  select="//block[@id='tp_ws_xslt']/content[@lang=$lang]" /></li>
              <li property="foaf:topic_interest"><xsl:value-of select="//block[@id='tp_ws_rdf']/content[@lang=$lang]" />
              </li>
              <li property="foaf:topic_interest"><xsl:value-of
                  select="//block[@id='tp_ws_rdfa']/content[@lang=$lang]" /></li>
            </ul>
          </div>
        </div>
      </section>

      <!-- Section Vidéo -->
      <section id="video" class="section" data-aos="fade-up">
        <div class="container">
          <h2><xsl:value-of select="//block[@id='video_title']/content[@lang=$lang]" /></h2>
          <div class="video-wrapper">
            <xsl:value-of select="//block[@id='video_iframe']/content[@lang=$lang]" disable-output-escaping="yes" />
          </div>
        </div>
      </section>

      <!-- Section Contact -->
      <section id="contact" class="section" data-aos="fade-up">
        <div class="container">
          <div class="section-header">
            <h2><xsl:value-of select="//block[@id='nav_contact']/content[@lang=$lang]" /></h2>
            <p class="section-subtitle"><xsl:value-of select="//block[@id='subtitle_contact']/content[@lang=$lang]" />
            </p>
          </div>

          <div class="contact-info">
            <p>Email : <a href="mailto:{//block[@id='personal_email']/content[@lang=$lang]}"
                property="foaf:mbox"><xsl:value-of select="//block[@id='personal_email']/content[@lang=$lang]" /></a>
            </p>
            <p>LinkedIn : <a href="{//block[@id='account_linkedin_url']/content[@lang=$lang]}" property="foaf:homepage"
                target="_blank">linkedin.com/in/amira-haouet</a></p>

            <!-- Informations de contact supplémentaires cachées -->
            <div style="display: none;">
              <span property="foaf:based_near" typeof="foaf:Organization">
                <span property="foaf:name"><xsl:value-of
                    select="//block[@id='personal_location']/content[@lang=$lang]" /></span>
              </span>
            </div>
          </div>
        </div>
      </section>

      <!-- Footer -->
      <footer class="footer">
        <div class="container">
          <p>© <xsl:value-of select="//block[@id='footer_year']/content[@lang=$lang]" /> <span
              property="foaf:name"><xsl:value-of select="//block[@id='personal_name']/content[@lang=$lang]" /></span>.
            <xsl:value-of select="//block[@id='footer_rights']/content[@lang=$lang]" /></p>
          <p property="foaf:made"><xsl:value-of select="//block[@id='footer_made']/content[@lang=$lang]" /></p>
        </div>
      </footer>

      <button class="scroll-to-top" id="scrollToTop" aria-label="Haut de page">
        <i class="fas fa-chevron-up"></i>
      </button>

      <script src="https://unpkg.com/aos@next/dist/aos.js" defer="defer"></script>
      <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js" defer="defer"></script>
      <script src="/static/js/portfolio.js" defer="defer"></script>

    </body>



<script src="https://unpkg.com/aos@next/dist/aos.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js" defer></script>
<script src="/static/js/portfolio.js" defer></script>

<!-- Métadonnées FOAF supplémentaires pour les moteurs de recherche -->
<script>
  function switchLang(lang) {
    document.documentElement.lang = lang;
    localStorage.setItem("lang", lang);
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const txt = el.getAttribute(`data-${lang}`);
      if (txt) el.textContent = txt;
    });
  }

  // Charger la langue au démarrage
  const savedLang = localStorage.getItem("lang") || "fr";
  switchLang(savedLang);

  // Attacher les clics sur les drapeaux
  document.querySelectorAll('.language-selector-nav a').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const lang = link.getAttribute('href').replace('?lang=', '');
      switchLang(lang);
    });
  });

  (async function () {
    const availableLangs = ['fr', 'en', 'ar', 'ja'];
    const defaultLang = 'fr';
    const xmlPath = '/static/portfolio.xml'; // <-- adapte ce chemin si nécessaire

    function getLang() {
      const urlParam = new URLSearchParams(window.location.search).get("lang");
      if (availableLangs.includes(urlParam)) return urlParam;
      const sessionLang = sessionStorage.getItem("lang");
      if (availableLangs.includes(sessionLang)) return sessionLang;
      const browserLang = navigator.language?.substring(0, 2);
      if (availableLangs.includes(browserLang)) return browserLang;
      return defaultLang;
    }

    function applyTranslations(xml, lang) {
      const blocks = xml.querySelectorAll('block');
      blocks.forEach(block => {
        const id = block.getAttribute('id');
        const content = block.querySelector(`content[lang="${lang}"]`);
        if (content && content.textContent) {
          const target = document.querySelector(`[data-block="${id}"]`);
          if (target) target.innerHTML = content.textContent;
        }
      });

      // Iframe vidéo si présent
      const videoBlock = xml.querySelector('block#video_iframe > content[lang="' + lang + '"]');
      if (videoBlock) {
        const wrapper = document.querySelector('#video iframe');
        if (wrapper) {
          wrapper.outerHTML = videoBlock.textContent.trim();
        }
      }

      // Metadonnées (titre, description, etc.)
      const titleBlock = xml.querySelector('block#personal_title > content[lang="' + lang + '"]');
      if (titleBlock) {
        document.title = `Amira Haouet – ${titleBlock.textContent}`;
      }

      const metaDesc = xml.querySelector('block#meta_description > content[lang="' + lang + '"]');
      if (metaDesc) {
        document.querySelector('meta[name="description"]').setAttribute('content', metaDesc.textContent);
      }

      sessionStorage.setItem("lang", lang);
      document.documentElement.lang = lang;
    }

    function attachLanguageSwitch() {
      document.querySelectorAll('.language-selector-nav a').forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          const lang = link.getAttribute('href').split('lang=')[1];
          const url = new URL(window.location.href);
          url.searchParams.set('lang', lang);
          sessionStorage.setItem('lang', lang);
          window.location.href = url.toString();
        });
      });
    }

    // Charger le XML et appliquer la langue
    try {
      const lang = getLang();
      const response = await fetch(xmlPath);
      const text = await response.text();
      const parser = new DOMParser();
      const xml = parser.parseFromString(text, "application/xml");
      applyTranslations(xml, lang);
      attachLanguageSwitch();
    } catch (err) {
      console.error("Erreur lors du chargement des traductions XML :", err);
    }
  })();
</script>


    </html>
  </xsl:template>
</xsl:stylesheet>